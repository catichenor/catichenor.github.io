<!DOCTYPE html>
<html lang="en">
<head>
		<title>EatYourAlgorithms &mdash; Articles tagged python</title>
		<meta charset="utf-8" />
                <!--<link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>-->
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link rel="stylesheet" type="text/css" href="/theme/css/style.css" />
		<link rel='stylesheet' id='oswald-css'  href='//fonts.googleapis.com/css?family=Oswald&#038;ver=3.3.2' type='text/css' media='all' />
		<style type="text/css">
			body.custom-background { background-color: #f5f5f5; }
		</style>
		<link rel="alternate" type="application/atom+xml"
			title="EatYourAlgorithms — Flux Atom"
			href="/" /> 
		<!--[if lte IE 8]><script src="/theme/js/html5shiv.js"></script><![endif]-->
</head>

<body class="home blog custom-background " >
	<div id="container">
		<div id="header">
				<h1 id="site-title"><a href="">EatYourAlgorithms</a></h1>
		</div><!-- /#banner -->
		
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/category/algorithms.html">Algorithms</a></li>
						<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/category/site.html">Site</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="#">If you don’t do vegetables, do your drugs, and eat your algorithms, you can be big and strong like me!</a></li>

				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
<div class="page-title">
	<h2>Tagged with <span>python</span> &hellip;</h2>
</div>
		</div>
	
		<div id="contents">
<div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/day-three.html">Sun 25 March 2018</a></div>
		<span class="byline">By <a href="/author/christopher-tichenor.html">Christopher Tichenor</a></span>
			<span class="cat-links"><a href="/category/algorithms.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/day-three.html" title="Permalink to Day Three" rel="bookmark">Day Three</a>
		</h2>
		<div class="entry-content">
			<h2>How to Read/Write a BMP file using Bytes and Bytearrays</h2>
<p>As a follow-up from yesterday, apparently using inheritance isn’t much better for <a href="https://medium.com/@george.shuklin/why-you-cant-remove-parent-methods-in-python-d4935e6d54a4">removing methods from a parent</a>. Ah well.</p>
<p>Time to move on to working with some of the other array types. On the varying data side, I’m pretty familiar with lists and tuples, so I won’t waste time with those. On the single-data-type side I’m pretty familiar with strings too (though it’s tempting to play with the newly-discovered recursion aspect). That leaves Bytes and Bytearrays.</p>
<p>It might be a good exercise to try to <a href="https://stackoverflow.com/questions/20276458/working-with-bmp-files-in-python-3">read a BMP file again</a> as I’d attempted to do at a class preceding PyBay 2017.</p>
<hr>
<p>First off, we need to read the file:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/Users/chris/Dropbox/Experiments/eatyouralgorithms/bmptest.bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">orig_bmp</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>


<p>Here's what it looks like for reference:</p>
<p><img alt="I'm actually a trained artist. Go figure." src="/images/003_bmptest.png"></p>
<p>Now, let's decode the bytes like in the article:</p>
<div class="highlight"><pre><span></span><span class="n">orig_bmp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</pre></div>


<p>Error!</p>
<div class="highlight"><pre><span></span>    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    &lt;ipython-input-2-7b9b1a26efec&gt; in &lt;module&gt;()
    ----&gt; 1 orig_bmp.read(2).decode()


    AttributeError: &#39;bytes&#39; object has no attribute &#39;read&#39;
</pre></div>


<p>Oops. That doesn't work. What if I try to print the whole thing?</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">)</span>
</pre></div>


<p>And we get...</p>
<div class="highlight"><pre><span></span>    IOPub data rate exceeded.
    The notebook server will temporarily stop sending output
    to the client in order to avoid crashing it.
    To change this limit, set the config variable
    `--NotebookApp.iopub_data_rate_limit`.
</pre></div>


<p>Yes, I'm using a Jupyter Notebook for these tests, suppose I should've guessed that would happen. </p>
<p>Let's try doing exactly what the original StackOverflow article recommends against. <a href="https://en.wikipedia.org/wiki/BMP_file_format">The Wikipedia article</a> says that the first 14 bytes are the header:</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">13</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>b&#39;BM6v/\x00\x00\x00\x00\x006\x00\x00&#39;
</pre></div>


<p>Ech. My hexadecimal sucks so this is effectively gibberish to me. What if we try printing decimals? (<em>I went through a few iterations of this before realizing where the cutoff should be.</em>)</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">60</span><span class="p">]):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{}:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
</pre></div>


<p>This prints out:</p>
<div class="highlight"><pre><span></span>    0:66
    1:77
    2:54
    3:118
    4:47
    5:0
    6:0
    7:0
    8:0
    9:0
    10:54
    11:0
    12:0
    13:0
    14:40
    15:0
    16:0
    17:0
    18:56
    19:4
    20:0
    21:0
    22:48
    23:253
    24:255
    25:255
    26:1
    27:0
    28:32
    29:0
    30:0
    31:0
    32:0
    33:0
    34:0
    35:0
    36:0
    37:0
    38:19
    39:11
    40:0
    41:0
    42:19
    43:11
    44:0
    45:0
    46:0
    47:0
    48:0
    49:0
    50:0
    51:0
    52:0
    53:0
    54:255
    55:255
    56:255
    57:255
    58:255
    59:255
</pre></div>


<p>It looks like at byte 54 we start going into the image data. This also isn't telling me a whole lot more than that. Let's try the Struct module, <a href="https://stackoverflow.com/questions/47003833/how-to-read-bmp-file-header-in-python">this</a> seems to give better information on using it:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">struct</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/Users/chris/Dropbox/Experiments/eatyouralgorithms/bmptest.bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Type:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Reserved 1: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Reserved 2: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Offset: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;DIB Header Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Width: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Height: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Colour Planes: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Bits per Pixel: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Compression Method: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Raw Image Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Horizontal Resolution: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Vertical Resolution: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of Colours: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Important Colours: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>


<p>Which results in:</p>
<div class="highlight"><pre><span></span>    Type: BM
    Size: 3110454
    Reserved 1: 0
    Reserved 2: 0
    Offset: 54
    DIB Header Size: 40
    Width: 1080
    Height: 4294966576
    Colour Planes: 1
    Bits per Pixel: 32
    Compression Method: 0
    Raw Image Size: 0
    Horizontal Resolution: 2835
    Vertical Resolution: 2835
    Number of Colours: 0
    Important Colours: 0
</pre></div>


<p>Something's going haywire when we read the "Height" metadata, but then I think the "Colour" planes is ok, and the "Bits per Pixel" looks right. How the hell the resolution is determined beats me.</p>
<p><a href="https://stackoverflow.com/questions/12464310/getting-incorrect-width-when-decoding-bitmap#12465956">StackOverflow to the rescue</a> again, looks like Acorn may have put a negative value in for the height, denoting that it's top-down rather than the typical bottom-up. Let's fix that:</p>
<div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/Users/chris/Dropbox/Experiments/eatyouralgorithms/bmptest.bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Type:&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Reserved 1: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Reserved 2: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Offset: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;DIB Header Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Width: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Height: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>  <span class="c1"># &lt;- Change to signed int</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Colour Planes: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Bits per Pixel: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Compression Method: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Raw Image Size: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Horizontal Resolution: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Vertical Resolution: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of Colours: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Important Colours: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>


<p>And now we get:</p>
<div class="highlight"><pre><span></span>    Type: BM
    Size: 3110454
    Reserved 1: 0
    Reserved 2: 0
    Offset: 54
    DIB Header Size: 40
    Width: 1080
    Height: -720
    Colour Planes: 1
    Bits per Pixel: 32
    Compression Method: 0
    Raw Image Size: 0
    Horizontal Resolution: 2835
    Vertical Resolution: 2835
    Number of Colours: 0
    Important Colours: 0
</pre></div>


<p>That looks right now.</p>
<p>Okay so after reading all of that data, does that match up with where the image data starts? Let me extract the bytes with some regexing in Sublime Text, which yields:</p>
<div class="highlight"><pre><span></span>2 4 2 2 4 4 4 4 2 2 4 4 4 4 4 4
</pre></div>


<p>I'll calculate this in Python because that's where I'm building up my fluency:</p>
<div class="highlight"><pre><span></span><span class="n">nums</span> <span class="o">=</span> <span class="s2">&quot;2 4 2 2 4 4 4 4 2 2 4 4 4 4 4 4&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">x</span>
<span class="c1"># Output: 54</span>
</pre></div>


<p>Bingo. That matches with where I saw the image data starting.</p>
<p>Now that we know where the pixel data starts, let's see where the pixel data is <em>not</em> black or white:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="mi">54</span><span class="p">:]):</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="mi">255</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;{}:{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>...blah blah blah...
    1461672:73
    1461673:73
    1461674:73
    1461676:231
    1461677:231
    1461678:231
    1462201:233
    1462202:227
    1462205:203
    1462206:191
    1462209:173
    1462210:155
    1462213:144
    1462214:118
    1462217:115
    1462218:83
    1462221:95
    1462222:58
    1462225:84
    1462226:46
...and so on and so forth...
</pre></div>


<p>At pixel 1462201 is where things start getting interesting, at least to me. This is where the pixels are not the same in all three channels, which means these are colored pixels. Acorn, bless its heart, does not use partial pixel antialiasing, so when it antialiases a transition between black and white, all of the RGB values are increased/decreased at the same time.</p>
<p>The file metadata also indicates that the image data is 32bpp, which means we have an alpha channel. That's consistent with this data as we're seeing a 1 byte gap between the color data.</p>
<p>So, pixel 1462201 is where we should start seeing the "nose". What I'd like to do is change the color of the nose from blue to red. According to Acorn, the blue that I'm using uses 255 in the Blue channel, 4 in the Red channel, and 51 in the Green channel. I should flip that around so I'm using 255 in the Red channel, 4 in the Green channel, and 51 in the Red channel (yes, I know that color perception doesn't work that way, but the values should be "close enough" for a decent, if slightly magenta, red).</p>
<p>I iterated through this code to figure out what color is what:</p>
<div class="highlight"><pre><span></span><span class="n">mbmp</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="mi">54</span><span class="p">:])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mbmp</span><span class="p">),</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Green: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Red: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Blue: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mbmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>


<p>Which results in:</p>
<div class="highlight"><pre><span></span>...blah blah blah...
    Blue: 255
    Green: 51
    Red: 4
    Blue: 255
    Green: 51
    Red: 4
    Blue: 255
    Green: 51
    Red: 4
...blah blah blah...
</pre></div>


<p>Now let's put it all together:</p>
<div class="highlight"><pre><span></span><span class="n">output_bytes</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">output_bytes</span><span class="p">),</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">red</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">blue</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">green</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out.bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_bytes</span><span class="p">)</span>
</pre></div>


<p><img alt="That nose is not what I expected." src="/images/003_out_magenta.png"></p>
<p>It works! Okay, more magenta than I would've liked, but still, I edited the raw bytes of an image!</p>
<p>Upon further inspection it looks like I'm not actually modifying the blue value, both blue and red are at 255, which explains the magenta-ness.</p>
<p>Let's rework the color channels again:</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">),</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">orig_bmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">orig_bmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Green: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Red: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Blue: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>


<p>And now we have:</p>
<div class="highlight"><pre><span></span>...blah blah blah...
    Green: 51
    Red: 4
    Blue: 255
    Green: 51
    Red: 4
    Blue: 255
    Green: 51
    Red: 4
    Blue: 255
    Green: 51
    Red: 4
    Blue: 255
...blah blah blah...
</pre></div>


<p>Messing around with this code has showed me that I mixed up the alpha with the blue channel, now to fix:</p>
<div class="highlight"><pre><span></span><span class="n">output_bytes</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">orig_bmp</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">54</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">output_bytes</span><span class="p">),</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]:</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">red</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">green</span>
        <span class="n">output_bytes</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">blue</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;out.bmp&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_bytes</span><span class="p">)</span>
</pre></div>


<p><img alt="That nose isn't cold anymore!" src="/images/003_out.png"></p>
<p>And it actually works (for real this time)!</p>
		</div> <!--/#entry-content-->
    		<span class="tag-links"><strong>Tagged</strong>
 <a href="/tag/algorithms.html" rel="tag">algorithms</a>,  <a href="/tag/byte.html" rel="tag">byte</a>,  <a href="/tag/bytearray.html" rel="tag">bytearray</a>,  <a href="/tag/howto.html" rel="tag">howto</a>,  <a href="/tag/programming.html" rel="tag">programming</a>,  <a href="/tag/python.html" rel="tag">python</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post--><div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/day-two.html">Sat 24 March 2018</a></div>
		<span class="byline">By <a href="/author/christopher-tichenor.html">Christopher Tichenor</a></span>
			<span class="cat-links"><a href="/category/algorithms.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/day-two.html" title="Permalink to Day Two" rel="bookmark">Day Two</a>
		</h2>
		<div class="entry-content">
			<h2>Using <code>array.array</code> and limiting its capabilities</h2>
<p>Well, if you need to use an array to create an array, I guess that's what I need to do. I suppose this makes sense given that the original computers were giant, inefficient memory arrays, so arrays are built in to the system.</p>
<p>These exercises apply different limits on Python's "built-in" array.array construct.</p>
<p>By the way, yes, I realize I could just inherit the previous classes for each iteration of the <code>IntArray</code>, but I'm not confident enough in my inheritance knowledge just yet.</p>
<p>With that out of the way...</p>
<hr>
<p>First, we're just going to make a prototype of our array that doesn't really have any limits, other than being limited to <code>int</code>s:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>

<span class="k">class</span> <span class="nc">IntArray</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">coll</span><span class="p">)</span>
</pre></div>


<p>Now let's test it out:</p>
<div class="highlight"><pre><span></span><span class="n">test_array</span> <span class="o">=</span> <span class="n">IntArray</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">test_array</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Returns: array(&#39;i&#39;, [1, 2, 3, 4, 5])</span>
</pre></div>


<p>So far so good, but what if we create a new <code>IntArray</code> with a String?</p>
<div class="highlight"><pre><span></span><span class="n">test2</span> <span class="o">=</span> <span class="n">IntArray</span><span class="p">(</span><span class="s1">&#39;blah&#39;</span><span class="p">)</span>
<span class="c1"># Results in an exception, as expected.</span>
</pre></div>


<hr>
<p>Now, let's give our array the ability to add items. We'll need to define an <code>add_data</code> method and call it in <code>__init__</code>, leveraging the <code>extend</code> functionality of <code>array.array</code>:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IntArrayAdd</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
</pre></div>


<p>Now to test:</p>
<div class="highlight"><pre><span></span><span class="n">test_array2</span> <span class="o">=</span> <span class="n">IntArrayAdd</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">test_array2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Returns: array(&#39;i&#39;, [6, 7, 8, 9, 10])</span>
</pre></div>


<p>Let's add some data:</p>
<div class="highlight"><pre><span></span><span class="n">test_array2</span><span class="o">.</span><span class="n">add_data</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>

<span class="k">print</span><span class="p">(</span><span class="n">test_array2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Returns: array(&#39;i&#39;, [6, 7, 8, 9, 10, 1, 2, 3, 4, 5])</span>
</pre></div>


<hr>
<p>Now let's add an explicit limit on the amount of items that the array can hold, and throw an <code>AttributeError</code> if we try to stuff too much into it:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IntArrayAddCheck</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;There are too many items for the specified limit of this array.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
</pre></div>


<p>Let's make sure we can't add too much to it when instantiating the class:</p>
<div class="highlight"><pre><span></span><span class="c1"># test_array3 = IntArrayAddCheck([1,2,3,4,5], 3)  </span>
<span class="c1"># Raises an AttributeError, as expected, we fed it 5 ints but only told it to hold 3.</span>
</pre></div>


<p>So far so good. Let's be nice to it now:</p>
<div class="highlight"><pre><span></span><span class="n">test_array4</span> <span class="o">=</span> <span class="n">IntArrayAddCheck</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">test_array4</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># Returns: array(&#39;i&#39;, [1, 2, 3, 4, 5])</span>
</pre></div>


<p>Now let's be mean again and try to give it more data:</p>
<div class="highlight"><pre><span></span><span class="n">test_array4</span><span class="o">.</span><span class="n">add_data</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="c1"># Raises an AttributeError</span>
</pre></div>


<p>w00t.</p>
<hr>
<p>This kinda bugs me though:</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">test_array4</span><span class="p">)</span>
<span class="c1"># Returns: &lt;__main__.IntArrayAddCheck object at 0x106f20780&gt;</span>
</pre></div>


<p>That's not great, but I also don't want to return the array data as is, since we know that this is going to be an <code>int</code> array. I just want to return the values as they appear inside the array.</p>
<p>So, let's add a <code>__repr__</code> method to fix that:</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IntArrayAddCheckRepr</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">add_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coll</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;There are too many items for the specified limit of this array.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coll</span><span class="p">)</span>
</pre></div>


<p>And now to test that:</p>
<div class="highlight"><pre><span></span><span class="n">test_array6</span> <span class="o">=</span> <span class="n">IntArrayAddCheckRepr</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_array6</span><span class="p">)</span>
<span class="c1"># Returns: [10, 9, 8, 7, 6]</span>
</pre></div>


<p>Yay.</p>
<p>Slight problem, though. We can do this:</p>
<div class="highlight"><pre><span></span><span class="n">test_array6</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_array6</span><span class="p">)</span>
<span class="c1"># Returns: [10, 9, 8, 7, 6, 3, 4, 5]</span>
</pre></div>


<p>I think I'll need to leverage inheritance to block this. Eh, out of time, have to wait 'til later.</p>
		</div> <!--/#entry-content-->
    		<span class="tag-links"><strong>Tagged</strong>
 <a href="/tag/algorithms.html" rel="tag">algorithms</a>,  <a href="/tag/arrays.html" rel="tag">arrays</a>,  <a href="/tag/datastructures.html" rel="tag">datastructures</a>,  <a href="/tag/howto.html" rel="tag">howto</a>,  <a href="/tag/programming.html" rel="tag">programming</a>,  <a href="/tag/python.html" rel="tag">python</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post--><div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/day-one.html">Thu 22 March 2018</a></div>
		<span class="byline">By <a href="/author/christopher-tichenor.html">Christopher Tichenor</a></span>
			<span class="cat-links"><a href="/category/algorithms.html" title="View all posts in Algorithms" rel="category tag">Algorithms</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/day-one.html" title="Permalink to Day One" rel="bookmark">Day One</a>
		</h2>
		<div class="entry-content">
			<h2>Types of Arrays in Python</h2>
<p>As noted in the Reddit article from yesterday, before going into algorithms you need to be solid on data structures and attempt to implement your own.</p>
<p>Initially I was going to attempt to do arrays, linked lists, and stacks/queues today, but there's enough to do in arrays themselves to fill at least a day's work.</p>
<h2>Arrays</h2>
<p>I'm using <a href="https://dbader.org/blog/python-arrays">this article</a> for guidance.</p>
<p>Arrays as defined here and in the article are collections of individual pieces of data that are stored contiguously in memory as opposed to pieces of data that are linked together and capable of occupying different areas of memory.</p>
<p>From this article, Python has 3 types of arrays for different types of data:</p>
<ul>
<li><strong>Lists:</strong> basically dynamic arrays that allocate and release data as needed based on the number of items in them and are mutable. They support mixed data types, but are space inefficient because of this.</li>
<li><strong>Tuples:</strong> arrays that cannot be added to or removed from, but also support different data types. If you add elements to a tuple, you create a new tuple.</li>
<li><strong>array.array(s):</strong> <code>array.array</code> must be imported from a Python module and can only hold one type of data. They are more space-efficient than the above two array types, and can be appended to.</li>
</ul>
<p>There's another three types of arrays for single data types:</p>
<ul>
<li><strong>Strings:</strong> Immutable and only store single character <code>String</code> objects recursively.</li>
<li><strong>Bytes:</strong> Also immutable, and can only store ints between 0-255
    <code>python
    &gt;&gt;&gt; bytes((0, 255))
    b'\x00\xff'</code></li>
<li><strong>Bytearrays:</strong> Mutable form of a byte object, can be added to, modified, and deleted from. Converting to a <code>byte</code> object is an O(n) process.</li>
</ul>
<p><a href="https://en.wikipedia.org/wiki/Array_data_type">Here's</a> the Wikipedia article on arrays. And <a href="https://stackoverflow.com/questions/4062752/in-what-structure-is-a-python-object-stored-in-memory#4062900">here's</a> a StackOverflow description of low-level implementation of Python array types.</p>
<p>The task here to implement my own array in Python seems to be to create a Python object with the following attributes:</p>
<ol>
<li>Multiple items are stored in this object.</li>
<li>Data is stored contiguously in memory.</li>
<li>Data can be accessed by index.</li>
</ol>
<p>1 and 3 seem to be fairly simple. 2, however, is not from what I can tell. Looking through the Python docs, it looks like the way to create new data types is via <a href="https://docs.python.org/3.6/extending/newtypes.html">PyObject</a>. Backing out to the <a href="https://docs.python.org/3.6/extending/index.html">primary article that contains that article</a>, I'll basically need to drop back to C to be able to store memory contiguously...</p>
<p>...Except even C doesn't seem to allow one to make an array without using an array, which feels like cheating. Perhaps a variation of <a href="https://www.quora.com/How-do-I-create-a-matrix-of-n*n-without-using-an-array-in-C-programming-language">this</a> might work (wait, nevermind, it also uses an array). I suppose I could also drop back to <a href="http://www.cs.uwm.edu/classes/cs315/Bacon/Lecture/HTML/ch12s04.html">assembler</a> but <em>wow</em> is that going into the weeds.</p>
<p>Not a great start. Today's lesson is a bit of a failure, but at least I learned a lot. Maybe the correct approach for this will become more obvious as I study more.</p>
		</div> <!--/#entry-content-->
    		<span class="tag-links"><strong>Tagged</strong>
 <a href="/tag/algorithms.html" rel="tag">algorithms</a>,  <a href="/tag/arrays.html" rel="tag">arrays</a>,  <a href="/tag/datastructures.html" rel="tag">datastructures</a>,  <a href="/tag/howto.html" rel="tag">howto</a>,  <a href="/tag/programming.html" rel="tag">programming</a>,  <a href="/tag/python.html" rel="tag">python</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post--><div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/mission-statement.html">Thu 22 March 2018</a></div>
		<span class="byline">By <a href="/author/christopher-tichenor.html">Christopher Tichenor</a></span>
			<span class="cat-links"><a href="/category/site.html" title="View all posts in Site" rel="category tag">Site</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/mission-statement.html" title="Permalink to Mission Statement" rel="bookmark">Mission Statement</a>
		</h2>
		<div class="entry-content">
			<p>The goal of this site, at least for now, is for public accountability of my efforts toward learning algorithms. As I’ve found out, it’s really quite difficult to get a job involving even entry-level coding without knowledge of algorithms pulled randomly out of a book (and apparently unrelated to actual life/job experience). I’m definitely not an entry-level coder, but I’m largely self-taught and thus have little background in algorithms.</p>
<p>So how shall I study these? There’s a few variables:</p>
<ul>
<li>What language to use.</li>
<li>What sites provide the best path to learning.</li>
<li>What learning method to use.</li>
</ul>
<h2>Language</h2>
<p>I’m thinking four possibilities: C/C++, Java, JavaScript, Python </p>
<h3>C, then C++ for OO</h3>
<ul>
<li>Pros<ul>
<li>Closer to the metal, will learn manual memory management </li>
<li>Many tutorials map closely to the specific data structure implementations of the C family </li>
<li>Many imaging libraries, especially on embedded hardware, use C++</li>
<li>More impressive in interviews(?)</li>
</ul>
</li>
<li>Cons<ul>
<li>I haven’t used either C or C++ much in a decade.</li>
<li>Have to learn the idiosyncrasies of two (related) languages.</li>
<li>Code is more “fiddly”, will take longer thair complete lessons.</li>
<li>Have to manually manage memory.</li>
</ul>
</li>
</ul>
<h3>Java</h3>
<ul>
<li>Pros<ul>
<li>Used by most automation engineers from what I can tell.</li>
<li>Doesn’t have as many "sticky points" as C/C++</li>
<li>Only have to use one language.</li>
<li>My most recent programming classes used Java, so this should be “review”.</li>
</ul>
</li>
<li>Cons<ul>
<li>I haven’t used Java much in the past decade, either.</li>
<li>Pretty far from technologies I’m interested in (except maybe Scala).</li>
<li>In something of a no man’s land between low-level and high-level languages.</li>
<li>Icky, boilerplate-y.</li>
</ul>
</li>
</ul>
<h3>JavaScript</h3>
<ul>
<li>Pros<ul>
<li>Will he helpful for front-end web (and maybe backend) programming.</li>
<li>I’ve used JavaScript much more recently than Java and C/C++</li>
<li>Good excuse to learn new JavaScript enhancements </li>
</ul>
</li>
<li>Cons<ul>
<li>Not really suited for algorithms </li>
<li>More of a functional language with C-ish syntax</li>
<li>Almost a DSL for browsers (I know, Node.js makes it a server language, but that ship seems to be sailing...)</li>
<li>High-level</li>
</ul>
</li>
</ul>
<h3>Python</h3>
<ul>
<li>Pros<ul>
<li>The primary language I'm currently using.</li>
<li>I've lots of tooling to support my work.</li>
<li>Pythonista gives me a way to do exercises on-the-go.</li>
<li>A very flexible language, can help with most of what I want to do.</li>
<li>Popular, lots of tutorials available.</li>
</ul>
</li>
<li>Cons<ul>
<li>High-level</li>
<li>Doesn't really map well to certain algorithms (can't work with pointers, etc.)</li>
<li>A relatively slow language.</li>
</ul>
</li>
</ul>
<p>I <em>really</em> want to do C/C++ but time is of the essence so I think the best option here is Python.</p>
<h2>Sites</h2>
<p><a href="https://medium.freecodecamp.org/5-key-learnings-from-the-post-bootcamp-job-search-9a07468d2331">This page</a> I read last weekend was pretty insightful. Here's the sites directly lifted from that, seems like a good place to start:</p>
<blockquote>
<ul>
<li><a href="https://www.interviewcake.com/">InterviewCake</a>: My favorite resource for data structures and algorithms. It breaks down solutions into step-by-step chunks — a great alternative to Cracking the Code Interview (CTCI). My only gripe is that they don’t have more problems!</li>
<li><a href="https://www.hiredintech.com/classrooms/system-design/lesson/60">HiredInTech’s System Design Section</a>: A great guide for system design interview questions.</li>
<li><a href="https://www.educative.io/collection/5642554087309312/5679846214598656">Coderust</a>: If you’re avoiding CTCI like the plague, Coderust 2.0 may be perfect for you. For $49, you get solutions in almost any programming language, with interactive diagrams.</li>
<li><a href="https://www.reddit.com/r/cscareerquestions/comments/1jov24/heres_how_to_prepare_for_tech_interviews/">Reddit’s How to Prepare for Tech Interviews</a>: I constantly used this as a benchmark for how prepared I was.</li>
<li><a href="https://github.com/h5bp/Front-end-Developer-Interview-Questions">Front End Interview Questions</a>: An <em>exhaustive</em> list of front-end questions.</li>
<li><a href="https://leetcode.com/">Leetcode</a>: The go-to resource for algorithm and data structure questions. You can filter by company, so for example, you could get all the questions that Uber or Google typically ask.</li>
</ul>
</blockquote>
<p>My notes on each:</p>
<ul>
<li><strong>InterviewCake:</strong> $99 for 1 year/50 hours of practice questions. Not too bad of a deal.</li>
<li><strong>HiredInTech System Design:</strong> Looks like it's free? Not a bad deal at all. I think I got a pretty good idea of systems architecture in my last job but it might be good to formalize that.</li>
<li><strong>Coderust/educative.io:</strong> $49 for lifetime access and 83 lessons. Also a pretty good deal.<ul>
<li>By the way, CTCI refers to "Cracking the Coding Interview", which I am indeed avoiding like the plague (too popular).</li>
</ul>
</li>
<li><strong>Reddit article:</strong> It's Reddit, so of course it's free*, but yeah, seems like a good benchmark.</li>
<li><strong>GitHub Front End Interview Questions:</strong> I'm not terribly interested in front-end development, but this could be useful.</li>
<li><strong>Leetcode:</strong> I downloaded an app that collects info from this site, not sure if it requires a subscription, which is $35/month or $159/year.</li>
</ul>
<h2>Learning Method</h2>
<p>Judging from my typical work method, I'll set a goal of 3 algorithms a day, and adjust based on my pace. I'll also need to alter the questions to protect the innocent.</p>
		</div> <!--/#entry-content-->
    		<span class="tag-links"><strong>Tagged</strong>
 <a href="/tag/c.html" rel="tag">C</a>,  <a href="/tag/c.html" rel="tag">C++</a>,  <a href="/tag/howto.html" rel="tag">howto</a>,  <a href="/tag/java.html" rel="tag">Java</a>,  <a href="/tag/javascript.html" rel="tag">JavaScript</a>,  <a href="/tag/learning.html" rel="tag">learning</a>,  <a href="/tag/programming.html" rel="tag">programming</a>,  <a href="/tag/python.html" rel="tag">Python</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post--><div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
		<div class="date"><a href="/fr1st-p0st.html">Tue 20 March 2018</a></div>
		<span class="byline">By <a href="/author/christopher-tichenor.html">Christopher Tichenor</a></span>
			<span class="cat-links"><a href="/category/site.html" title="View all posts in Site" rel="category tag">Site</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="/fr1st-p0st.html" title="Permalink to Fr1st P0st" rel="bookmark">Fr1st P0st</a>
		</h2>
		<div class="entry-content">
			<p>Yes, this dates me as an olde time Slashdot user. Buck feta!</p>
<p>I’m writing this before I’ve even registered my domain because I want everything <em>about</em> this site chronicled <em>in</em> the site. I’ll get to my mission statement in the next post.</p>
<p>Apologies for the stream-of-consciousness nature of the prose here.</p>
<h2>Domain Registrar</h2>
<p>First order of business is to pick a domain registrar... time to start Googling. Hm, a couple of hits, a fair amount of what looks like sponsored posts... GoDaddy is fairly low-ranked which is a good sign... <a href="https://makeawebsitehub.com/go/namecheap">NameCheap</a> and <a href="https://makeawebsitehub.com/go/bluehost">BlueHost</a> might work? Providers may be gaming the algorithm, DuckDuckGo to the rescue! </p>
<p>Ech, a few articles from 2010 and 2012... </p>
<p>Ooh, <a href="https://makeawebsitehub.com/reviews/domain-registrars/">this is a nice article</a>.</p>
<p>Looks like NameCheap it is. I'll follow up if they screw me over.</p>
<h2>Site Architecture</h2>
<p>Next is how to actually implement the site. I don't really care for comments, my Wordpress site from 6-7 years ago had its comments system overrun by Russian hackers, which I blocked by disabling the comments section and removing them from the stylesheet, so I'd rather just not have them altogether. </p>
<p>A static site generator looks to be the right tool here, and I could probably leverage GitHub for hosting. Jekyll is the obvious choice, except that it'd require that I learn Ruby for modifications and Ruby is... meh. Unless you're looking to hire me, in which case, I <em>love</em> Ruby!</p>
<p>Off to <a href="https://github.com/vinta/awesome-python#static-site-generator">Awesome Python</a>... quite a few options here, looks like <a href="https://github.com/eudicots/Cactus">Cactus</a> runs on Django, also meh... <a href="https://github.com/hyde/hyde">Hyde</a> (I see what they did there) looks promising, but hasn't been updated in about two years. <a href="https://github.com/getnikola/nikola">Nikola</a> seems like a strong contender, last update was a few hours ago, might be a bit heavyweight, though... <a href="https://github.com/getpelican/pelican">Pelican</a> looks like a contender. <a href="https://github.com/vladris/tinkerer/">Tinkerer</a> doesn't really look compatible with my knowledge base.</p>
<p>So... Nikola or Pelican. Both seem to have pretty <a href="https://fedoramagazine.org/make-github-pages-blog-with-pelican/">decent</a> <a href="http://journalpanic.com/pyhi/posts/make-your-own-blog-with-github-pages-and-nikola/">tutorials</a>. Nikola looks to have a direct CLI for GitHub pages, which is nice, but also still looks fairly complicated. I think I'll go with Pelican for now, looks like it should be fairly easy to switch out if something doesn't pan out.</p>
<h2>Building the Site</h2>
<p>Time to make a <a href="https://pages.github.com">GitHub Pages</a>, um, page? Go through the tutorial, la la la... okay done, go to the site... not working? Try again a minute later... now it works. "Hello World" indeed.</p>
<p>Okay now to set up Pelican. Hm, instructions also want me to make a <code>[username].github.io-src</code> repo, okay, done... now it wants me to install the Python Pelican package? I'm not on Fedora so, no. I should probably pip install in a virtualenv... all the tutorials say to have a dedicated Pelican virtualenv? That doesn't sound right, but whatever. </p>
<p>Alright, looks like I should probably use this sequence:</p>
<div class="highlight"><pre><span></span>python3 -m venv Pelican
<span class="nb">cd</span> Pelican
<span class="nb">source</span> bin/activate
</pre></div>


<p>Okay, now we're in our virtualenv. Now to install Pelican and a few dependencies:</p>
<div class="highlight"><pre><span></span>pip3 install pelican
pip3 install Markdown typogrify
</pre></div>


<p>Okay, now we have our packages, time to set up the site. Doesn't seem right to do it here, maybe I can go back to the other directory?</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span> ../catichenor.github.io-src
</pre></div>


<p>The next step, which I assume to be <code>git submodule add git@github.com:catichenor/catichenor.github.io.git output</code> from the tutorial, doesn't work. Eh, maybe just skip straight to:</p>
<div class="highlight"><pre><span></span>pelican-quickstart
</pre></div>


<p>Okay done.</p>
<p>Now to write up a post based on the example from the docs:</p>
<div class="highlight"><pre><span></span>Title: This is a test.
Date: 2018-03-20 15:18
Modified: 2018-03-20 15:20
Category: Site
Tags: pelican, publishing
Slug: this-is-a-test
Authors: Christopher Tichenor
Summary: This is a test page, hopefully I can delete this.

This is a test. This is only a test.
</pre></div>


<p>Make and test the site... wow that's ugly. Okay, at least let me change the post to this one I'm typing, I can update it later.</p>
<p>Okay, that looks better, kinda. Now to publish to GitHub. Eh, looks like I didn't do the submodule thing correctly. Ugh. Okay, <code>cp -r output/* ../catichenor.github.io/</code> to the rescue here. I'll need to automate that plus probably some other stuff.</p>
<p>Next on the todo list is to get the domain stuff set up and switch up the theme but at least we have a working site. Good night!</p>
<hr>
<p><strong>UPDATE:</strong> Okay, did a bit more tweaking here. It was bugging me that git submodules weren't being set up. After doing some digging, it looks like I need to run the following to get the submodule set up after the fact:</p>
<div class="highlight"><pre><span></span>git submodule add https://github.com/catichenor/catichenor.github.io.git output
</pre></div>


<hr>
<p><strong>ANOTHER UPDATE:</strong> Wow, no offense to most Pelican theme makers, but most Pelican themes look awful. Chunk looks pretty decent, let's apply that... okay, I need to add the entry to the <code>pelicanconf.py</code> file in the page's source repo.</p>
<p>Okay, Chunk definitely looks better but I need to modify the links... done. The "SITE" link is annoying but I'll figure out how to hide that later.</p>
		</div> <!--/#entry-content-->
    		<span class="tag-links"><strong>Tagged</strong>
 <a href="/tag/backend.html" rel="tag">backend</a>,  <a href="/tag/bash.html" rel="tag">bash</a>,  <a href="/tag/documentation.html" rel="tag">documentation</a>,  <a href="/tag/domain.html" rel="tag">domain</a>,  <a href="/tag/git.html" rel="tag">git</a>,  <a href="/tag/howto.html" rel="tag">howto</a>,  <a href="/tag/meta.html" rel="tag">meta</a>,  <a href="/tag/python.html" rel="tag">python</a>,  <a href="/tag/scripting.html" rel="tag">scripting</a>,  <a href="/tag/site.html" rel="tag">site</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post--><div class="navigation">
</div>
		</div>
		
		<div id="footer">
			<p>Powered by <a href="http://getpelican.com">Pelican</a>, theme by <a href="http://bunnyman.info">tBunnyMan</a>.</p>
		</div><!-- /#footer -->
	</div><!-- /#container -->
	<div style="display:none"></div>
</body>
</html>